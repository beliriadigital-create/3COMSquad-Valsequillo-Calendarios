<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3COM Squad Valsequillo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #b01c68; --dark: #4a1033; }
        body { 
            font-family: 'Inter', sans-serif; margin: 0; padding: 20px; color: white;
            background: #4a1033 url('fondo.png') no-repeat center center fixed; background-size: cover;
        }
        body::before { content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: -1; }
        .header { text-align: center; margin-bottom: 30px; }
        .logo { max-width: 800px; width: 100%; height: auto; }
        
        .destacado-card { 
            background: white; color: #1a1a1a; border-radius: 20px; padding: 20px;
            max-width: 600px; margin: 0 auto 40px; text-align: center; border-left: 10px solid var(--primary);
        }
        .destacado-tag { background: var(--primary); color: white; padding: 5px 15px; border-radius: 50px; font-size: 0.8rem; font-weight: 900; }
        .resultado-box { background: var(--dark); color: white; font-size: 2.5rem; font-weight: 900; padding: 10px 20px; border-radius: 10px; display: inline-block; margin: 15px 0; }

        .cat-section { max-width: 800px; margin: 0 auto 20px; background: rgba(255,255,255,0.1); border-radius: 15px; overflow: hidden; }
        .cat-header { background: var(--primary); padding: 15px; font-weight: 900; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .btn-cal { background: white; color: var(--primary); padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.7rem; font-weight: 900; }
        
        .partido-row { background: white; color: #333; margin: 10px; padding: 15px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; }
        .p-fecha { font-weight: 800; color: var(--primary); min-width: 110px; }
        .p-equipos { flex-grow: 1; font-weight: 700; padding: 0 10px; }
        .p-res { background: #eee; padding: 5px 10px; border-radius: 5px; font-weight: 900; }
    </style>
</head>
<body>
    <div class="header"><img src="logo.png" class="logo"></div>
    <div id="destacado"></div>
    <div id="categorias-lista"></div>

    <script>
        async function cargar() {
            const res = await fetch('categories.json?v=' + Date.now());
            const cats = await res.json();
            const lista = document.getElementById('categorias-lista');
            let todosLosPartidos = [];

            for (const c of cats) {
                try {
                    const rp = await fetch(`./${c.slug}/partidos.json?v=` + Date.now());
                    const data = await rp.json();
                    
                    let htmlPartidos = '';
                    data.matches.forEach(m => {
                        todosLosPartidos.push({...m, cat: c.name});
                        htmlPartidos += `
                            <div class="partido-row">
                                <div class="p-fecha">${m.fecha_texto || m.visitante}</div>
                                <div class="p-equipos">${m.local} vs ${m.visitante}</div>
                                <div class="p-res">${m.resultado || 'vs'}</div>
                            </div>`;
                    });

                    lista.innerHTML += `
                        <div class="cat-section">
                            <div class="cat-header">
                                <span>${c.name}</span>
                                <a href="./${c.slug}/calendar.ics" class="btn-cal">üìÖ A√ëADIR AL CALENDARIO</a>
                            </div>
                            <div class="cat-body">${htmlPartidos || '<p style="padding:10px">No hay partidos listados</p>'}</div>
                        </div>`;
                } catch(e) {}
            }
            
            // Pintar el primero como destacado (ejemplo simple)
            if(todosLosPartidos.length > 0) {
                const p = todosLosPartidos[0];
                document.getElementById('destacado').innerHTML = `
                    <div class="destacado-card">
                        <span class="destacado-tag">${p.cat}</span><br><br>
                        <strong>${p.fecha_texto || p.visitante}</strong>
                        <h3>${p.local} vs ${p.visitante}</h3>
                        <div class="resultado-box">${p.resultado || 'VS'}</div>
                        <p>üìç ${p.lugar}</p>
                    </div>`;
            }
        }
        cargar();
    </script>
</body>
</html>
